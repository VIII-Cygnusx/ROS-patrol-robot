<?xml version="1.0"?>  
<robot name="square_robot" xmlns:xacro="http://www.ros.org/wiki/xacro">  
<!-- 小车自定义参数部分 -->
	<!-- xacro自定义变量参数 -->
    <!-- 轮子 宽0.044m 半径0.047m -->
    <xacro:property name="length_wheel" value="0.044" /> 
    <xacro:property name="radius_wheel" value="0.047" />
	<!-- 左右轮子与车身中心点(0,0,0)的vx轴距离 0.124m y轴距离 0.11m z轴距离 0.082m-->
	<xacro:property name="FL" value="0.124 0.11 -0.082"/>
    <xacro:property name="FR" value="0.124 -0.11 -0.082"/>
    <xacro:property name="BL" value="-0.124 0.11 -0.082"/>
    <xacro:property name="BR" value="-0.124 -0.11 -0.082"/>
	<!-- 长方体车身  (x方向)长=0.342m (y方向)宽0.16m (z方向)高=0.172-0.08m-->
	<xacro:property name="bodywork" value="0.342 0.16 0.164"/>
	<!-- 轮子与车身中心点的距离 0.11m -->
    <xacro:property name="PI"           value="3.1415926"/>
    <!-- 定义一个名为 default_inertial 的XACRO宏 接受“mass”这个参数 -->
    <xacro:macro name="default_inertial" params="mass">
        <!-- 物体惯性描述 -->
        <inertial>
            <!-- 接受mass的参数传递单位KG -->
            <mass value="${mass}" />
            <!-- 定义了物体的惯性张量。惯性张量是一个描述物体质量分布对旋转惯性的影响的3x3矩阵
            其中ixx、iyy和izz是物体在x、y和z轴上的转动惯量，而ixy、ixz和iyz是惯性积，这里都设为0，
            表示物体在这些轴上的质量分布是对称的 -->
            <inertia ixx="0.1" ixy="0.0" 
                     izz="0.1" ixz="0.0"
                     iyy="0.1" iyz="0.0"/>            
        </inertial>
    </xacro:macro>
<!-- 小车自定义参数部分 -->



<!-- 小车整体描述 -->
	<!-- 小车整体坐标部分 -->
    <!-- 用于定义机器人的一个刚体链接,这里会把2_car当成父坐标系 -->
    <link name="2_car">
    </link>
	<!-- 小车整体坐标部分 -->
	<!-- 底盘部分 -->
    <link name="base_footprint">
   		<visual>
			<geometry>
      				<box size="0.001 0.001 0.001"/>
     		</geometry>
			<!-- 这里会以它的的父坐标为准来显示base_footprint的位置和姿态 -->
   		</visual>
		<xacro:default_inertial mass="0.0001"/>     
 	</link>
	<!-- 底盘部分 -->
	<!-- 车身部分 -->
	<link name="base_link">
   		<visual>
			<geometry>
      				<box size="${bodywork}"/>
     		</geometry>
			<material name="white">
				<color rgba="1 1 1 1"/>
			</material>
   		</visual>
		<collision>
			<geometry>
       				<box size="${bodywork}"/>
			</geometry>
		</collision>
        <xacro:default_inertial mass="8.2"/>    
 	</link>
	<!-- 车身部分 -->
	<!-- 轮子部分 -->
	<xacro:macro name="wheel_" params="num">
 	<link name="wheel_${num}">
   		<visual>
     			<geometry>
					<!-- 轮子宽${length_wheel}，半径${radius_wheel} -->
       				<cylinder length="${length_wheel}" radius="${radius_wheel}"/>
     			</geometry>
   				<material name="black">
					<color rgba="0 0 0 1"/>
				</material>
		</visual>
		<collision>
			<geometry>
       				<cylinder length="${length_wheel}" radius="${radius_wheel}"/>
			</geometry>
		</collision>
		<xacro:default_inertial mass="0.5"/>
 	</link>
	</xacro:macro>
	<xacro:wheel_ num="1" />
	<xacro:wheel_ num="2" />
	<xacro:wheel_ num="3" />
	<xacro:wheel_ num="4" />
	<!-- 轮子部分 -->



	<!-- 底盘关节部分 -->
    <!-- 定义了一个名为2_car_joint的固定关节(fixed)
         并把2_car当成base_footprint的父坐标 -->
    <joint name="2_car_joint" type="fixed">
        <parent link = "2_car"/>
        <child  link = "base_footprint"/>
		<origin xyz  = "0 0 0" />
    </joint>
	<!-- 底盘关节部分 -->
	<!-- 车身关节部分 -->
	<joint name="base_footprint_joint" type="fixed">
		<parent link = "base_footprint" />
		<child  link = "base_link" />
		<origin xyz  = "0 0 0.126" />
	</joint>
	<!-- 车身关节部分 -->
	<!-- 轮子关节连接部分 -->
    <!-- 定义了一个名为wheel_joints的连续旋转的关节(continuous) xacro宏，没有固定的范围限制，例如电机驱动的轮子 -->
	<xacro:macro name="wheel_joints" params="num position">
		<joint name="base_to_wheel${num}" type="continuous">
			<parent link = "base_link"/>
			<child  link = "wheel_${num}"/>
			<origin rpy  = "${-PI/2} 0 0" xyz="${position}"/>
			<!-- 这定义了关节旋转的轴。xyz="0 0 1"意味着关节是沿着z轴旋转的 -->
			<axis   xyz  = "0 0 1" />
			<!-- 这是关节的限制 effort="100": 关节可以施加的最大努力（通常是以牛顿或牛顿·米为单位的力或力矩）
                          velocity="100": 关节可以达到的最大速度（通常是以弧度/秒为单位的角速度） -->
			<limit  effort = "1" velocity="33.504" />
		</joint>
	</xacro:macro>
	<xacro:wheel_joints num="1" position="${FL}" />
	<xacro:wheel_joints num="2" position="${BL}" />
	<xacro:wheel_joints num="3" position="${FR}" />
	<xacro:wheel_joints num="4" position="${BR}" />
	<!-- 轮子关节连接部分 -->
<!-- 小车整体描述 -->
	<gazebo>
	<plugin name="my_plugin" filename="libgazebo_hellow.so">
	</plugin>
	</gazebo>
</robot>

